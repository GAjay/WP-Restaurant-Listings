jQuery(document).ready(function(a){var t=[];a(".restaurant_listings").on("update_results",function(e,r,s,i){var n,o,l,d="",_=a(this),c=_.find(".restaurant_filters"),u=_.find(".showing_restaurants"),g=_.find(".restaurant_listings"),p=_.data("per_page"),h=_.data("orderby"),f=_.data("order"),w=_.data("featured"),v=_.data("restaurant_types"),m=_.data("post_status"),y=a("div.restaurant_listings").index(this);if(!(y<0)){if(t[y]&&t[y].abort(),s||(a(g).addClass("loading"),a("li.restaurant_listings, li.no_restaurant_listings_found",g).css("visibility","hidden"),r>1&&!0!==_.data("show_pagination")?a(g).before('<a class="load_more_restaurants load_previous" href="#"><strong>'+restaurant_listings_ajax_filters.i18n_load_prev_listings+"</strong></a>"):_.find(".load_previous").remove(),_.find(".load_more_restaurants").data("page",r)),!0===_.data("show_filters")){var k=[];a(':input[name="filter_restaurant_type[]"]:checked, :input[name="filter_restaurant_type[]"][type="hidden"], :input[name="filter_restaurant_type"]',c).each(function(){k.push(a(this).val())}),n=c.find(':input[name^="search_categories"]').map(function(){return a(this).val()}).get(),o="",l="",price_range=c.find(':input[name="search_price_range"]').val();var x=c.find(':input[name="search_keywords"]'),b=c.find(':input[name="search_location"]');x.val()!==x.attr("placeholder")&&(o=x.val()),b.val()!==b.attr("placeholder")&&(l=b.val()),d={lang:restaurant_listings_ajax_filters.lang,search_keywords:o,search_location:l,search_categories:n,filter_restaurant_type:k,search_price_range:price_range,filter_post_status:m,per_page:p,orderby:h,order:f,page:r,featured:w,show_pagination:_.data("show_pagination"),form_data:c.serialize()}}else n=_.data("categories"),o=_.data("keywords"),l=_.data("location"),price_range=_.data("price_range"),n&&(n=n.split(",")),d={lang:restaurant_listings_ajax_filters.lang,search_categories:n,search_keywords:o,search_location:l,filter_post_status:m,search_price_range:price_range,filter_restaurant_type:v,per_page:p,orderby:h,order:f,page:r,featured:w,show_pagination:_.data("show_pagination")};t[y]=a.ajax({type:"POST",url:restaurant_listings_ajax_filters.ajax_url.toString().replace("%%endpoint%%","get_listings"),data:d,success:function(t){if(t)try{t.showing?a(u).show().html("<span>"+t.showing+"</span>"+t.showing_links):a(u).hide(),t.showing_all?a(u).addClass("wp-restaurant-listings-showing-all"):a(u).removeClass("wp-restaurant-listings-showing-all"),t.html&&(s&&i?a(g).prepend(t.html):s?a(g).append(t.html):a(g).html(t.html)),!0===_.data("show_pagination")?(_.find(".restaurant-listings-pagination").remove(),t.pagination&&_.append(t.pagination)):(!t.found_restaurants||t.max_num_pages<=r?a(".load_more_restaurants:not(.load_previous)",_).hide():i||a(".load_more_restaurants",_).show(),a(".load_more_restaurants",_).removeClass("loading"),a("li.restaurant_listings",g).css("visibility","visible")),a(g).removeClass("loading"),_.triggerHandler("updated_results",t)}catch(a){window.console&&window.console.log(a)}},error:function(a,t,e){window.console&&"abort"!==t&&window.console.log(t+": "+e)},statusCode:{404:function(){window.console&&window.console.log("Error 404: Ajax Endpoint cannot be reached. Go to Settings > Permalinks and save to resolve.")}}})}}),a('#search_keywords, #search_location, .restaurant_types :input, #search_categories, .restaurant-listings-filter, input[name="search_price_range"]').change(function(){var t=a(this).closest("div.restaurant_listings");t.triggerHandler("update_results",[1,!1]),s(t,1)}).on("keyup",function(t){13===t.which&&a(this).trigger("change")}),a(".restaurant_filters").on("click",".reset",function(){var t=a(this).closest("div.restaurant_listings"),e=a(this).closest("form");return e.find(':input[name="search_keywords"], :input[name="search_location"], .restaurant-listings-filter').not(':input[type="hidden"]').val("").trigger("chosen:updated"),e.find(':input[name^="search_categories"]').not(':input[type="hidden"]').val(0).trigger("chosen:updated"),a(':input[name="filter_restaurant_type[]"]',e).not(':input[type="hidden"]').attr("checked","checked"),e.find(':input[name="search_price_range"]').val(""),e.find(".price_range_filter li").attr("style",""),t.triggerHandler("reset"),t.triggerHandler("update_results",[1,!1]),s(t,1),!1}),a(document.body).on("click",".load_more_restaurants",function(){var t=a(this).closest("div.restaurant_listings"),e=parseInt(a(this).data("page")||1,10),r=!1;return a(this).addClass("loading"),a(this).is(".load_previous")?(r=!0,1===(e-=1)?a(this).remove():a(this).data("page",e)):(e+=1,a(this).data("page",e),s(t,e)),t.triggerHandler("update_results",[e,!0,r]),!1}),a(".price_range_filter").on("click","li",function(t){a(".price_range_filter li").attr("style","");var e=a(this);a('input[name="search_price_range"]').attr("value",e.attr("data-price_range")),a('input[name="search_price_range"]').triggerHandler("change"),e.css({"background-color":"#c4f3a4",border:"1px solid #41a700",color:"#348c42"})}),a("div.restaurant_listings").on("click",".restaurant-listings-pagination a",function(){var t=a(this).closest("div.restaurant_listings"),e=a(this).data("page");return s(t,e),t.triggerHandler("update_results",[e,!1]),a("body, html").animate({scrollTop:t.offset().top},600),!1}),a.isFunction(a.fn.chosen)&&(1===restaurant_listings_ajax_filters.is_rtl&&a('select[name^="search_categories"]').addClass("chosen-rtl"),a('select[name^="search_categories"]').chosen({search_contains:!0}));var e=!1;window.history&&window.history.pushState&&(e=!0);var r=document.location.href.split("#")[0];function s(t,s){if(e){var i=t.find(".restaurant_filters"),n=a(i).serialize(),o=a("div.restaurant_listings").index(t);window.history.replaceState({id:"restaurant_listings_state",page:s,data:n,index:o},"",r+"#s=1")}}a(window).on("load",function(){a(".restaurant_filters").each(function(){var t=a(this).closest("div.restaurant_listings"),e=t.find(".restaurant_filters"),r=1,s=a("div.restaurant_listings").index(t);if(window.history.state&&window.location.hash){var i=window.history.state;i.id&&"restaurant_listings_state"===i.id&&s===i.index&&(r=i.page,e.deserialize(i.data),e.find(':input[name^="search_categories"]').not(':input[type="hidden"]').trigger("chosen:updated"))}t.triggerHandler("update_results",[r,!1])})})});